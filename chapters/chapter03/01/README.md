# 03-1 소켓에 할당되는 IP 주소와 PORT번호

IP는 Internet Protocol의 약자로 인터넷상에서 데이터를 송수신할 목적으로 컴퓨터에게 부여하는 값이다. 
반면 PORT번호는 컴퓨터에게 부여하는 값이 아닌, 프로그램상에서 생성되는 소켓을 구분하기 위해 소켓에 부여되는 번호를 뜻한다.

---

## 인터넷 주소(Internet Address)

인터넷에 컴퓨터를 연결해서 데이터를 주고받기 위해서는 IP주소를 부여 받아야 한다. 
이러한 IP주소체계는 두 종류로 나뉜다.

* IPv4(Internet Protocol version 4):     4바이트 주소체계
* IPv6(Internet Protocol version 6):     16바이트 주소체계

IPv4 기준의 4바이트 IP주소는 **네트워크 주소**와 **호스트(컴퓨터를 의미함) 주소**로 나뉘며, 주소의 형태에 따라서
A, B, C, D, E 클래스로 분류된다. 다음 그림은 IPv4의 주소 체계를 보여준다. 클래스 E는 일반적이지 않은, 예약되어 있는 주소 체계이다.

![GeeksForGeeks Classful IPv4 Addressing](https://media.geeksforgeeks.org/wp-content/cdn-uploads/IP_addressing_3.jpg)

**네트워크 주소**(네트워크 ID)란 네트워크의 구분을 위한 IP주소의 일부를 말한다. 예를 들어 www.keunbum.io라는 단체의 김대표에게 데이터를 전송한다고 가정해보자. 단체의 컴퓨터는 하나의 로컬 네트워크로 연결되어 있다. 그렇다면 먼저 keunbum.io의 네트워크로 데이터를 전송하는 것이 우선이다. 즉, 처음부터 4바이트 전부를 참조해서 김대표의 컴퓨터로 데이터가 전송되는 것이 아니라, 4바이트 중 네트워크 주소만을 참조하여 전송한다. keunbum.io의 네트워크로 데이터가 전송되었다면, 해당 네트워크(네트워크를 구성하는 라우터는) 전송된 데이터의 **호스트 주소**(호스트 ID)를 참조하여 김대표의 컴퓨터로 데이터를 전송해준다.


>🔖 **라우터와 스위치**
>
>네트워크를 구성하려면 외부로부터 수신된 데이터를 호스트에 전달하고, 호스트가 전달하는 데이터를 위부로 송신해주는 물리적 장치가 필요하다. 이를 가리켜 라우터 또는 스위치라 하는데, 이것도 그냥 컴퓨터에 지나지 않는다 다만 특수한 목적을 가지고 설계 및 운영되는 컴퓨터이기 때문에 라우터 또는 스위치라는 별도의 이름을 붙여준 것이다 라우터보다 기능적으로 작은 것을 가리켜 스위치라 부르는데, 사실상 이 둘은 같은 의미로 사용된다.


---

## 클래스 별 네트워크 주소와 호스트 주소의 경계

IP주소의 첫 번째 바이트만 보면 네으워크 주소가 몇 바이트인지 알 수 있다. 다음과 같이 클래스 별 IP주소의 경계를 나눠놓았기 때문이다.
- A 클래스의 첫 번째 바이트 범위:       0 이상 127 이하
- B 클래스의 첫 번째 바이트 범위:       128 이상 191 이하
- C 클래스의 첫 번째 바이트 범위:       192 이상 223 이하

이는 다음과 같이 표현할 수도 있다.
- A 클래스의 첫 번째 비트는 항상 0으로 시작
- B 클래스의 첫 두 비트는 항상 10으로 시작
- C 클래스의 첫 세 비트는 항상 110으로 시작

이러한 기준이 정해져 있기 때문에 소켓을 통해서 데이터를 송수신할 때, 우리가 별도로 신경 쓰지 않아도 
네트워크로 데이터가 이동하고 이어서 최종 목적지인 호스트로 데이터가 전송된다.


---

## 소켓의 구분에 활용되는 PORT번호

IP는 컴퓨터를 구분하기 위한 목적으로 존재한다. 때문에 IP만 있다면 목적지 컴퓨터로 데이터를 전송할 순 있다. 그러나 이것만 가지고 데이터를 수신해야 하는 최종 목적지인 응용프로그램에까지 데이터를 전송할 순 없다.  
예를 들어 현재 동영상을 시청하면서 인터넷 서핑을 함께하고 있다고 가정해보자. 그렇다면 최소한 동영상 데이터의 수신을 위한 소켓 하나와 인터넷 정보의 수신을 위한 소켓 하나가 필요하다. 그런데 이 둘을 어떻게 구분할 것인가?  
컴퓨터에는 NIC(Network Interface Card)라 불리는 데이터 송수신장치가 하나씩 달려 있다. IP는 데이터를 NIC을 통해 컴퓨터 내부로 전송하는데 사용된다. 그러나 컴퓨터 내부로 전송된 데이터를 소켓에 적절히 분배하는 작업은 운영체제가 담당한다. 이 때 운영체제는 PORT 번호를 활용한다. NIC를 통해서 수신된 데이터 안에는 PORT번호가 새겨져 있다. 운영체제는 바로 이 정보를 참조하여 일치하는 PORT번호의 소켓에 데이터를 전달하는 것이다.  
이렇듯 PORT번호는 운영체제 내에서 소켓을 구분하는 목적으로 사용되기 때문에 하나의 운영체제 내에서 동일한 PORT번호를 둘 이상의 소켓에 할당할 수 없다. 그리고 PORT번호는 16비트로 표현된다. 고로 할당할 수 있는 PORT번호의 범위는 0 이상 65535 이하이다. 그러나 0부터 1023번까지는 '잘 알려진 PORT(Well-known PORT)'라 해서, 특정 프로그램에 할당하기로 예약되어 있기 때문에, 이 범위를 제외한 다른 값을 할당해야 한다. 그리고 PORT번호는 중복이 불가능하지만, TCP소켓과 UDP소켓은 PORT번호를 공유하지 않기 때문에 중복되어도 상관없다.  
정리하면 우리가 말하는 데이터 전송의 목적지 주소에는 IP주소뿐만 아니라 POPT번호도 포함된다. 그래야 최종 목적지인 응용프로그램에까지(응용프로그램의 소켓까지) 데이터를 전달할 수 있기 때문이다.